!function(t){function o(o,s){function e(){return l.update(),i(),l}function a(){var t=v.toLowerCase();f.obj.css(p,w/m.ratio),h.obj.css(p,-w),M.start=f.obj.offset()[p],m.obj.css(t,x[s.axis]),x.obj.css(t,x[s.axis]),f.obj.css(t,f[s.axis])}function i(){y?d.obj[0].ontouchstart=function(t){1===t.touches.length&&(n(t.touches[0]),t.stopPropagation())}:(f.obj.bind("mousedown",n),x.obj.bind("mouseup",u)),s.scroll&&window.addEventListener?(b[0].addEventListener("DOMMouseScroll",r,!1),b[0].addEventListener("mousewheel",r,!1),b[0].addEventListener("MozMousePixelScroll",function(t){t.preventDefault()},!1)):s.scroll&&(b[0].onmousewheel=r)}function n(o){t("body").addClass("noSelect");var s=parseInt(f.obj.css(p),10);M.start=j?o.pageX:o.pageY,g.start="auto"==s?0:s,y?(document.ontouchmove=function(t){t.preventDefault(),u(t.touches[0])},document.ontouchend=c):(t(document).bind("mousemove",u),t(document).bind("mouseup",c),f.obj.bind("mouseup",c))}function r(o){if(h.ratio<1){var e=o||window.event,a=e.wheelDelta?e.wheelDelta/120:-e.detail/3;w-=a*s.wheel,w=Math.min(h[s.axis]-d[s.axis],Math.max(0,w)),f.obj.css(p,w/m.ratio),h.obj.css(p,-w),(s.lockscroll||w!==h[s.axis]-d[s.axis]&&0!==w)&&(e=t.event.fix(e),e.preventDefault()),b.trigger("scroll")}}function u(t){h.ratio<1&&(s.invertscroll&&y?g.now=Math.min(x[s.axis]-f[s.axis],Math.max(0,g.start+(M.start-(j?t.pageX:t.pageY)))):g.now=Math.min(x[s.axis]-f[s.axis],Math.max(0,g.start+((j?t.pageX:t.pageY)-M.start))),w=g.now*m.ratio,h.obj.css(p,-w),f.obj.css(p,g.now),b.trigger("scroll"))}function c(){t("body").removeClass("noSelect"),t(document).unbind("mousemove",u),t(document).unbind("mouseup",c),f.obj.unbind("mouseup",c),document.ontouchmove=document.ontouchend=null}var l=this,b=o,d={obj:t(".viewport",o)},h={obj:t(".overview",o)},m={obj:t(".scrollbar",o)},x={obj:t(".track",m.obj)},f={obj:t(".thumb",m.obj)},j="x"===s.axis,p=j?"left":"top",v=j?"Width":"Height",w=0,g={start:0,now:0},M={},y="ontouchstart"in document.documentElement;return this.update=function(t){return d[s.axis]=d.obj[0]["offset"+v],h[s.axis]=h.obj[0]["scroll"+v],h.ratio=d[s.axis]/h[s.axis],m.obj.toggleClass("hide",h.ratio>=1),x[s.axis]="auto"===s.size?d[s.axis]:s.size,f[s.axis]=Math.min(x[s.axis],Math.max(0,"auto"===s.sizethumb?x[s.axis]*h.ratio:s.sizethumb)),m.ratio="auto"===s.sizethumb?h[s.axis]/x[s.axis]:(h[s.axis]-d[s.axis])/(x[s.axis]-f[s.axis]),w="relative"===t&&h.ratio<=1?Math.min(h[s.axis]-d[s.axis],Math.max(0,w)):0,w="bottom"===t&&h.ratio<=1?h[s.axis]-d[s.axis]:isNaN(parseInt(t,10))?w:parseInt(t,10),a(),!0},e()}t.tiny=t.tiny||{},t.tiny.scrollbar={options:{axis:"y",wheel:40,scroll:!0,lockscroll:!0,size:"auto",sizethumb:"auto",invertscroll:!1}},t.fn.tinyscrollbar=function(s){var e=t.extend({},t.tiny.scrollbar.options,s);return this.each(function(){t(this).data("tsb",new o(t(this),e))}),this},t.fn.tinyscrollbar_update=function(o){return t(this).data("tsb")&&t(this).data("tsb").update(o)}}(jQuery);